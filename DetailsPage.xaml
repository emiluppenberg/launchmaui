<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
  x:Class="launchmaui.DetailsPage"
  xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
  xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
  xmlns:items="clr-namespace:launchmaui.VM.Items"
  xmlns:utilities="clr-namespace:launchmaui.Utilities"
  xmlns:vm="clr-namespace:launchmaui.VM"
  Title="{Binding Details.Title}"
  x:DataType="vm:DetailsVM">

  <ScrollView>
    <VerticalStackLayout Padding="20" Spacing="15">

      <!--  Back Button  -->
      <Border
        Padding="15,10"
        HorizontalOptions="Start"
        Stroke="#0078D7"
        StrokeShape="RoundRectangle 8"
        StrokeThickness="1">
        <Button
          BackgroundColor="Transparent"
          Command="{Binding GoToMainCommand}"
          Text="â† Back to Main"
          TextColor="#0078D7"
          WidthRequest="120" />
      </Border>

      <!--  Main Launch Image  -->
      <Border
        Padding="0"
        HorizontalOptions="Center"
        Stroke="#E0E0E0"
        StrokeShape="RoundRectangle 10"
        StrokeThickness="1">
        <Grid>
          <Image
            Aspect="AspectFill"
            HeightRequest="200"
            Source="fallback.jpg"
            WidthRequest="200" />
          <Image
            Aspect="AspectFill"
            HeightRequest="200"
            Source="{Binding Details.ThumbnailUrl}"
            WidthRequest="200" />
        </Grid>
      </Border>

      <!--  Launch Provider  -->
      <VerticalStackLayout Spacing="8">
        <Label
          Grid.Column="0"
          FontAttributes="Bold"
          FontSize="Subtitle"
          HorizontalOptions="Center"
          LineBreakMode="WordWrap"
          Text="{Binding Details.LspName}"
          TextColor="#1a237e" />
        <!--  Provider Logo  -->
        <Border
          Grid.Column="1"
          Margin="0,10"
          Padding="5"
          BackgroundColor="White"
          HorizontalOptions="Center"
          Stroke="#CCCCCC"
          StrokeShape="RoundRectangle 5"
          StrokeThickness="1">
          <Grid>
            <Image
              Aspect="AspectFill"
              HeightRequest="100"
              Source="fallback.jpg"
              WidthRequest="100" />
            <Image
              Aspect="AspectFit"
              HeightRequest="100"
              Source="{Binding Details.LspThumbnailUrl}"
              WidthRequest="100" />
          </Grid>
        </Border>
      </VerticalStackLayout>

      <!--  Mission Section  -->
      <Border
        Padding="15"
        BackgroundColor="#f0f8ff"
        Stroke="#E0E0E0"
        StrokeShape="RoundRectangle 8"
        StrokeThickness="1">
        <VerticalStackLayout Spacing="8">
          <Label
            FontAttributes="Bold"
            FontSize="Caption"
            Text="MISSION"
            TextColor="Gray" />
          <Label
            FontAttributes="Bold"
            FontSize="Title"
            Text="{Binding Details.MissionName}"
            TextColor="#1a237e" />
          <Label
            FontSize="Body"
            LineBreakMode="WordWrap"
            Text="{Binding Details.MissionDescription}"
            TextColor="#424242" />
        </VerticalStackLayout>
      </Border>

      <!--  Status Section  -->
      <Border
        Padding="15"
        BackgroundColor="#fff0f5"
        Stroke="#E0E0E0"
        StrokeShape="RoundRectangle 8"
        StrokeThickness="1">
        <VerticalStackLayout Spacing="8">
          <Label
            FontAttributes="Bold"
            FontSize="Caption"
            Text="LAUNCH STATUS"
            TextColor="Gray" />
          <Label
            FontAttributes="Bold"
            FontSize="Subtitle"
            Text="{Binding Details.StatusName}"
            TextColor="#880e4f" />
          <Label
            FontSize="Body"
            LineBreakMode="WordWrap"
            Text="{Binding Details.StatusDescription}"
            TextColor="#424242" />
        </VerticalStackLayout>
      </Border>

      <!--  Timeline Section  -->
      <Border
        Padding="15"
        BackgroundColor="#f0fff0"
        Stroke="#E0E0E0"
        StrokeShape="RoundRectangle 8"
        StrokeThickness="1">
        <VerticalStackLayout Spacing="10">
          <Label
            FontAttributes="Bold"
            FontSize="Caption"
            Text="LAUNCH TIMELINE"
            TextColor="Gray" />

          <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
            <!--  NET  -->
            <VerticalStackLayout Spacing="2">
              <Label
                FontSize="Micro"
                HorizontalOptions="Center"
                Text="NET"
                TextColor="Gray" />
              <Label
                FontAttributes="Bold"
                FontSize="Small"
                HorizontalOptions="Center"
                Text="{Binding Details.Net, StringFormat='{0:MMM dd, yyyy}'}" />
              <Label
                FontSize="Small"
                HorizontalOptions="Center"
                Text="{Binding Details.Net, StringFormat='{0:HH:mm}'}" />
            </VerticalStackLayout>

            <!--  Window Start  -->
            <VerticalStackLayout Grid.Column="1" Spacing="2">
              <Label
                FontSize="Micro"
                HorizontalOptions="Center"
                Text="Window Start"
                TextColor="Gray" />
              <Label
                FontAttributes="Bold"
                FontSize="Small"
                HorizontalOptions="Center"
                Text="{Binding Details.WindowStart, StringFormat='{0:MMM dd, yyyy}'}" />
              <Label
                FontSize="Small"
                HorizontalOptions="Center"
                Text="{Binding Details.WindowStart, StringFormat='{0:HH:mm}'}" />
            </VerticalStackLayout>

            <!--  Window End  -->
            <VerticalStackLayout Grid.Column="2" Spacing="2">
              <Label
                FontSize="Micro"
                HorizontalOptions="Center"
                Text="Window End"
                TextColor="Gray" />
              <Label
                FontAttributes="Bold"
                FontSize="Small"
                HorizontalOptions="Center"
                Text="{Binding Details.WindowEnd, StringFormat='{0:MMM dd, yyyy}'}" />
              <Label
                FontSize="Small"
                HorizontalOptions="Center"
                Text="{Binding Details.WindowEnd, StringFormat='{0:HH:mm}'}" />
            </VerticalStackLayout>
          </Grid>

          <Border
            Margin="0,10,0,0"
            Padding="10"
            BackgroundColor="#FFF3E0"
            IsVisible="{Binding Details.WeatherConcerns, Converter={x:Static utilities:Converters.StringNotNullOrEmpty}}"
            Stroke="#FFA726"
            StrokeShape="RoundRectangle 5"
            StrokeThickness="1">
            <HorizontalStackLayout Spacing="8">
              <Label FontSize="Body" Text="âš ï¸" />
              <Label
                FontSize="Small"
                LineBreakMode="WordWrap"
                Text="{Binding Details.WeatherConcerns}"
                TextColor="#E65100" />
            </HorizontalStackLayout>
          </Border>
        </VerticalStackLayout>
      </Border>

      <!--  Rocket  -->
      <Border
        Padding="15"
        BackgroundColor="#f5f5f5"
        Stroke="#E0E0E0"
        StrokeShape="RoundRectangle 8"
        StrokeThickness="1">
        <VerticalStackLayout Spacing="8">
          <Label
            FontAttributes="Bold"
            FontSize="Caption"
            Text="ðŸš€ ROCKET"
            TextColor="Gray" />
          <Label
            FontAttributes="Bold"
            FontSize="Subtitle"
            Text="{Binding Details.RocketName}"
            TextColor="#1a237e" />
          <Label
            FontSize="Small"
            LineBreakMode="WordWrap"
            Text="{Binding Details.RocketDescription}"
            TextColor="#424242" />
        </VerticalStackLayout>
      </Border>

      <!--  Location Section  -->
      <Grid ColumnDefinitions="*,*" ColumnSpacing="15">

        <!--  Launch Pad  -->
        <Border
          Padding="15"
          BackgroundColor="#fffaf0"
          Stroke="#E0E0E0"
          StrokeShape="RoundRectangle 8"
          StrokeThickness="1">
          <VerticalStackLayout Spacing="8">
            <Label
              FontAttributes="Bold"
              FontSize="Caption"
              Text="LAUNCH PAD"
              TextColor="Gray" />
            <Label
              FontAttributes="Bold"
              FontSize="Subtitle"
              Text="{Binding Details.PadName}"
              TextColor="#1a237e" />
            <Label
              FontSize="Small"
              HorizontalOptions="Center"
              Text="{Binding Details.PadLocationName}"
              TextColor="#424242" />

            <!--  Pad Map Image  -->
            <Border
              Margin="0,10"
              Padding="5"
              BackgroundColor="White"
              HorizontalOptions="Center"
              Stroke="#CCCCCC"
              StrokeShape="RoundRectangle 5"
              StrokeThickness="1">
              <Grid>
                <Image
                  Aspect="AspectFill"
                  HeightRequest="100"
                  Source="fallback.jpg"
                  WidthRequest="100" />
                <Image
                  Aspect="AspectFill"
                  HeightRequest="100"
                  Source="{Binding Details.PadMapImageUrl}"
                  WidthRequest="100" />
              </Grid>
            </Border>
          </VerticalStackLayout>
        </Border>

        <!--  Landing Location  -->
        <Border
          Grid.Column="1"
          Padding="15"
          BackgroundColor="#fffaf0"
          Stroke="#E0E0E0"
          StrokeShape="RoundRectangle 8"
          StrokeThickness="1">
          <VerticalStackLayout Spacing="8">
            <Label
              FontAttributes="Bold"
              FontSize="Caption"
              Text="LANDING LOCATION"
              TextColor="Gray" />
            <Label
              FontAttributes="Bold"
              FontSize="Subtitle"
              IsVisible="{Binding Details.LandingName, Converter={x:Static utilities:Converters.StringNotNullOrEmpty}}"
              Text="{Binding Details.LandingName}"
              TextColor="#1a237e" />
            <Label
              Margin="0,40"
              FontAttributes="Italic"
              FontSize="Small"
              HorizontalOptions="Center"
              IsVisible="{Binding Details.LandingName, Converter={x:Static utilities:Converters.StringIsNullOrEmpty}}"
              Text="No landing location specified"
              TextColor="Gray" />

            <!--  Landing Location Image  -->
            <Border
              Margin="0,10"
              Padding="5"
              BackgroundColor="White"
              HorizontalOptions="Center"
              IsVisible="{Binding Details.LandingThumbnailUrl, Converter={x:Static utilities:Converters.StringNotNullOrEmpty}}"
              Stroke="#CCCCCC"
              StrokeShape="RoundRectangle 5"
              StrokeThickness="1">
              <Grid>
                <Image
                  Aspect="AspectFill"
                  HeightRequest="100"
                  Source="fallback.jpg"
                  WidthRequest="100" />
                <Image
                  Aspect="AspectFill"
                  HeightRequest="100"
                  Source="{Binding Details.LandingThumbnailUrl}"
                  WidthRequest="100" />
              </Grid>
            </Border>
          </VerticalStackLayout>
        </Border>
      </Grid>

      <!--  Additional Info Section  -->
      <Border
        Padding="15"
        BackgroundColor="#f8f8f8"
        IsVisible="{Binding Details.Url, Converter={x:Static utilities:Converters.StringNotNullOrEmpty}}"
        Stroke="#E0E0E0"
        StrokeShape="RoundRectangle 8"
        StrokeThickness="1">
        <HorizontalStackLayout HorizontalOptions="Center">
          <VerticalStackLayout Spacing="8">
            <Label
              FontAttributes="Bold"
              FontSize="Caption"
              Text="ADDITIONAL INFORMATION"
              TextColor="Gray" />

            <Border
              Padding="8,5"
              BackgroundColor="#E3F2FD"
              Stroke="#0078D7"
              StrokeShape="RoundRectangle 5"
              StrokeThickness="1">
              <Label
                FontAttributes="Bold"
                FontSize="Small"
                IsVisible="{Binding Details.Url, Converter={x:Static utilities:Converters.StringNotNullOrEmpty}}"
                Text="Open Source Link"
                TextColor="#0078D7">
                <Label.GestureRecognizers>
                  <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.OpenUrlCommand}" CommandParameter="{Binding Details.Url}" />
                </Label.GestureRecognizers>
              </Label>
            </Border>
          </VerticalStackLayout>
        </HorizontalStackLayout>
      </Border>

    </VerticalStackLayout>
  </ScrollView>
</ContentPage>
